<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Constructor for a a multivariate hidden Markov model (HMM) where each of the
n variables observed at the same time has a (potentially different)
standard univariate distribution conditionally on the underlying state.  The
n outcomes are independent conditionally on the hidden state."><title>Multivariate hidden Markov models — hmmMV • msm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multivariate hidden Markov models — hmmMV"><meta property="og:description" content="Constructor for a a multivariate hidden Markov model (HMM) where each of the
n variables observed at the same time has a (potentially different)
standard univariate distribution conditionally on the underlying state.  The
n outcomes are independent conditionally on the hidden state."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">msm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/chjackson/msm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Multivariate hidden Markov models</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/msm/blob/HEAD/R/hmm-dists.R" class="external-link"><code>R/hmm-dists.R</code></a></small>
      <div class="d-none name"><code>hmmMV.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Constructor for a a multivariate hidden Markov model (HMM) where each of the
<code>n</code> variables observed at the same time has a (potentially different)
standard univariate distribution conditionally on the underlying state.  The
<code>n</code> outcomes are independent conditionally on the hidden state.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hmmMV</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>...</dt>
<dd><p>The number of arguments supplied should equal the maximum number
of observations made at one time.  Each argument represents the univariate
distribution of that outcome conditionally on the hidden state, and should
be the result of calling a univariate hidden Markov model constructor (see
<code><a href="hmm-dists.html">hmm-dists</a></code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of objects, each of class <code>hmmdist</code> as returned by the
univariate HMM constructors documented in <code><a href="hmm-dists.html">hmm-dists</a></code>.  The
whole list has class <code>hmmMVdist</code>, which inherits from <code>hmmdist</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If a particular state in a HMM has such an outcome distribution, then a call
to <code>hmmMV</code> is supplied as the corresponding element of the
<code>hmodel</code> argument to <code><a href="msm.html">msm</a></code>.  See Example 2 below.</p>
<p>A multivariate HMM where multiple outcomes at the same time are generated
from the <em>same</em> distribution is specified in the same way as the
corresponding univariate model, so that <code>hmmMV</code> is not required.
The outcome data are simply supplied as a matrix instead of a vector.  See
Example 1 below.</p>
<p>The outcome data for such models are supplied as a matrix, with number of
columns equal to the maximum number of arguments supplied to the
<code>hmmMV</code> calls for each state.  If some but not all of the
variables are missing (<code>NA</code>) at a particular time, then the observed
data at that time still contribute to the likelihood.  The missing data are
assumed to be missing at random.  The Viterbi algorithm may be used to
predict the missing values given the fitted model and the observed data.</p>
<p>Typically the outcome model for each state will be from the same family or
set of families, but with different parameters.  Theoretically, different
numbers of distributions may be supplied for different states.  If a
particular state has fewer outcomes than the maximum, then the data for that
state are taken from the first columns of the response data matrix.  However
this is not likely to be a useful model, since the number of observations
will probably give information about the underlying state, violating the
missing at random assumption.</p>
<p>Models with outcomes that are dependent conditionally on the hidden state
(e.g. correlated multivariate normal observations) are not currently
supported.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jackson, C. H., Su, L., Gladman, D. D. and Farewell, V. T.
(2015) On modelling minimal disease activity.  Arthritis Care and Research
(early view).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="hmm-dists.html">hmm-dists</a></code>,<code><a href="msm.html">msm</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Simulate data from a Markov model </span></span></span>
<span class="r-in"><span><span class="va">nsubj</span> <span class="op">&lt;-</span> <span class="fl">30</span>; <span class="va">nobspt</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">sim.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>subject <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nsubj</span>, each<span class="op">=</span><span class="va">nobspt</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, length<span class="op">=</span><span class="va">nobspt</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">two.q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="simmulti.msm.html">simmulti.msm</a></span><span class="op">(</span><span class="va">sim.df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, qmatrix<span class="op">=</span><span class="va">two.q</span>, drop.absorb<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### EXAMPLE 1</span></span></span>
<span class="r-in"><span><span class="co">## Generate two observations at each time from the same outcome</span></span></span>
<span class="r-in"><span><span class="co">## distribution:</span></span></span>
<span class="r-in"><span><span class="co">## Bin(40, 0.1) for state 1, Bin(40, 0.5) for state 2</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">obs1</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">40</span>, <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">obs2</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">40</span>, <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">obs1</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">40</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">obs2</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">40</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>obs1 <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">obs1</span>, obs2 <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">obs2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fitted model should approximately recover true parameters </span></span></span>
<span class="r-in"><span><span class="fu"><a href="msm.html">msm</a></span><span class="op">(</span><span class="va">obs</span> <span class="op">~</span> <span class="va">time</span>, subject<span class="op">=</span><span class="va">subject</span>, data<span class="op">=</span><span class="va">dat</span>, qmatrix<span class="op">=</span><span class="va">two.q</span>,</span></span>
<span class="r-in"><span>    hmodel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="hmm-dists.html">hmmBinom</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">40</span>, prob<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  <span class="fu"><a href="hmm-dists.html">hmmBinom</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">40</span>, prob<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Optimisation has probably not converged to the maximum likelihood - Hessian is not positive definite.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msm(formula = obs ~ time, subject = subject, data = dat, qmatrix = two.q,     hmodel = list(hmmBinom(size = 40, prob = 0.2), hmmBinom(size = 40,         prob = 0.2)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimisation probably not converged to the maximum likelihood.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> optim() reported convergence but estimated Hessian not positive-definite.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2 * log-likelihood:  3706.02 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### EXAMPLE 2</span></span></span>
<span class="r-in"><span><span class="co">## Generate two observations at each time from different</span></span></span>
<span class="r-in"><span><span class="co">## outcome distributions:</span></span></span>
<span class="r-in"><span><span class="co">## Bin(40, 0.1) and Bin(40, 0.2) for state 1, </span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">obs1</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">obs2</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">obs1</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">40</span>, <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">obs2</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">40</span>, <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Bin(40, 0.5) and Bin(40, 0.6) for state 2</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">obs1</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">40</span>, <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">obs2</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">40</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>obs1 <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">obs1</span>, obs2 <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">obs2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fitted model should approximately recover true parameters </span></span></span>
<span class="r-in"><span><span class="fu"><a href="msm.html">msm</a></span><span class="op">(</span><span class="va">obs</span> <span class="op">~</span> <span class="va">time</span>, subject<span class="op">=</span><span class="va">subject</span>, data<span class="op">=</span><span class="va">dat</span>, qmatrix<span class="op">=</span><span class="va">two.q</span>,   </span></span>
<span class="r-in"><span>    hmodel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">hmmMV</span><span class="op">(</span><span class="fu"><a href="hmm-dists.html">hmmBinom</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">40</span>, prob<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        <span class="fu"><a href="hmm-dists.html">hmmBinom</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">40</span>, prob<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>,                 </span></span>
<span class="r-in"><span>                 <span class="fu">hmmMV</span><span class="op">(</span><span class="fu"><a href="hmm-dists.html">hmmBinom</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">40</span>, prob<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       <span class="fu"><a href="hmm-dists.html">hmmBinom</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">40</span>, prob<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">10000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> msm(formula = obs ~ time, subject = subject, data = dat, qmatrix = two.q,     hmodel = list(hmmMV(hmmBinom(size = 40, prob = 0.3), hmmBinom(size = 40,         prob = 0.3)), hmmMV(hmmBinom(size = 40, prob = 0.3),         hmmBinom(size = 40, prob = 0.3))), control = list(maxit = 10000))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum likelihood estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Transition intensities</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Baseline                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1 - State 1 -0.09458 (-0.13940,-0.06416)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1 - State 2  0.09458 ( 0.06416, 0.13940)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hidden Markov model, 2 states</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome 1 - binomial distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate       LCL       UCL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> size 40.0000000        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> prob  0.1054793 0.0948457 0.1171507</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome 2 - binomial distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate       LCL       UCL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> size 40.0000000        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> prob  0.1958908 0.1818942 0.2106871</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> State 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome 1 - binomial distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate       LCL      UCL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> size 40.0000000        NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> prob  0.5954564 0.5780108 0.612664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome 2 - binomial distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate       LCL      UCL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> size 40.0000000        NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> prob  0.5110363 0.4933762 0.528669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2 * log-likelihood:  1523.652 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

