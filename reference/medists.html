<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Truncated Normal and Uniform distributions, where the response is also
subject to a Normally distributed measurement error."><title>Measurement error distributions — medists • msm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Measurement error distributions — medists"><meta property="og:description" content="Truncated Normal and Uniform distributions, where the response is also
subject to a Normally distributed measurement error."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">msm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/chjackson/msm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Measurement error distributions</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/msm/blob/HEAD/R/msm-package.R" class="external-link"><code>R/msm-package.R</code></a>, <a href="https://github.com/chjackson/msm/blob/HEAD/R/utils.R" class="external-link"><code>R/utils.R</code></a></small>
      <div class="d-none name"><code>medists.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Truncated Normal and Uniform distributions, where the response is also
subject to a Normally distributed measurement error.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dmenorm</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  sderr <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  meanerr <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pmenorm</span><span class="op">(</span></span>
<span>  <span class="va">q</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  sderr <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  meanerr <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  lower.tail <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  log.p <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">qmenorm</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  sderr <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  meanerr <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  lower.tail <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  log.p <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rmenorm</span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span>, lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, upper <span class="op">=</span> <span class="cn">Inf</span>, sderr <span class="op">=</span> <span class="fl">0</span>, meanerr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dmeunif</span><span class="op">(</span><span class="va">x</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span>, sderr <span class="op">=</span> <span class="fl">0</span>, meanerr <span class="op">=</span> <span class="fl">0</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pmeunif</span><span class="op">(</span></span>
<span>  <span class="va">q</span>,</span>
<span>  lower <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  upper <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sderr <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  meanerr <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  lower.tail <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  log.p <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">qmeunif</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  lower <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  upper <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sderr <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  meanerr <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  lower.tail <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  log.p <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rmeunif</span><span class="op">(</span><span class="va">n</span>, lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span>, sderr <span class="op">=</span> <span class="fl">0</span>, meanerr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x, q</dt>
<dd><p>vector of quantiles.</p></dd>


<dt>mean</dt>
<dd><p>vector of means.</p></dd>


<dt>sd</dt>
<dd><p>vector of standard deviations.</p></dd>


<dt>lower</dt>
<dd><p>lower truncation point.</p></dd>


<dt>upper</dt>
<dd><p>upper truncation point.</p></dd>


<dt>sderr</dt>
<dd><p>Standard deviation of measurement error distribution.</p></dd>


<dt>meanerr</dt>
<dd><p>Optional shift for the measurement error distribution.</p></dd>


<dt>log, log.p</dt>
<dd><p>logical; if TRUE, probabilities \(p\) are given as
\(\log(p)\), or log density is returned.</p></dd>


<dt>lower.tail</dt>
<dd><p>logical; if TRUE (default), probabilities are \(P[X &lt;=
x]\), otherwise, \(P[X &gt; x]\).</p></dd>


<dt>p</dt>
<dd><p>vector of probabilities.</p></dd>


<dt>n</dt>
<dd><p>number of observations. If <code>length(n) &gt; 1</code>, the length is
taken to be the number required.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>dmenorm</code>, <code>dmeunif</code> give the density, <code>pmenorm</code>,
<code>pmeunif</code> give the distribution function, <code>qmenorm</code>,
<code>qmeunif</code> give the quantile function, and <code>rmenorm</code>,
<code>rmeunif</code> generate random deviates, for the Normal and Uniform versions
respectively.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The normal distribution with measurement error has density</p>
<p>$$ $$$$
\frac{\Phi(u, \mu_2, \sigma_3) - \Phi(l, \mu_2, }{(Phi(upper, mu2, sigma3) -
Phi(lower, mu2, sigma3)) / (Phi(upper, mean, sd) - Phi(lower, mean, sd)) *
phi(x, mean + meanerr, sigma2)}\deqn{ \sigma_3)}{\Phi(u, \mu_0, \sigma_0) -
\Phi(l, \mu_0, \sigma_0)} $$$$ \phi(x, \mu_0 + \mu_\epsilon, \sigma_2)
$$$$
$$ where
$$\sigma_2^2 = \sigma_0^2 + \sigma_\epsilon^2,$$ $$\sigma_3 = \sigma_0 \sigma_\epsilon / \sigma_2,$$ $$\mu_2 = (x - \mu_\epsilon) \sigma_0^2 + \mu_0
$$$$
\sigma_\epsilon^2,$$</p>
<p>\(\mu_0\) is the mean of the original Normal distribution before
truncation, <br> \(\sigma_0\) is the corresponding standard deviation,
<br> \(u\) is the upper truncation point, <br> \(l\) is the lower
truncation point, <br> \(\sigma_\epsilon\) is the standard deviation
of the additional measurement error, <br> \(\mu_\epsilon\) is the
mean of the measurement error (usually 0). <br> \(\phi(x)\) is the
density of the corresponding normal distribution, and <br>
\(\Phi(x)\) is the distribution function of the corresponding
normal distribution.</p>
<p>The uniform distribution with measurement error has density</p>
<p>$$(\Phi(x, \mu_\epsilon+l, \sigma_\epsilon) - \Phi(x, \mu_\epsilon+u,
\sigma_\epsilon)) $$$$ / (u - l)$$</p>
<p>These are calculated from the original truncated Normal or Uniform density
functions \(f(. | \mu, \sigma, l, u)\) as</p>
<p>$$\int f(y $$$$ | \mu, \sigma, l, u) \phi(x, y $$$$ + \mu_\epsilon, \sigma_\epsilon)
dy$$</p>
<p>If <code>sderr</code> and <code>meanerr</code> are not specified they assume the default
values of 0, representing no measurement error variance, and no constant
shift in the measurement error, respectively.</p>
<p>Therefore, for example with no other arguments, <code>dmenorm(x)</code>, is simply
equivalent to <code>dtnorm(x)</code>, which in turn is equivalent to
<code>dnorm(x)</code>.</p>
<p>These distributions were used by Satten and Longini (1996) for CD4 cell
counts conditionally on hidden Markov states of HIV infection, and later by
Jackson and Sharples (2002) for FEV1 measurements conditionally on states of
chronic lung transplant rejection.</p>
<p>These distribution functions are just provided for convenience, and are not
optimised for numerical accuracy or speed.  To fit a hidden Markov model
with these response distributions, use a <code><a href="hmm-dists.html">hmmMETNorm</a></code> or
<code><a href="hmm-dists.html">hmmMEUnif</a></code> constructor. See the <code><a href="hmm-dists.html">hmm-dists</a></code> help
page for further details.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Satten, G.A. and Longini, I.M.  Markov chains with measurement
error: estimating the 'true' course of a marker of the progression of human
immunodeficiency virus disease (with discussion) <em>Applied Statistics</em>
45(3): 275-309 (1996)</p>
<p>Jackson, C.H. and Sharples, L.D. Hidden Markov models for the onset and
progression of bronchiolitis obliterans syndrome in lung transplant
recipients <em>Statistics in Medicine</em>, 21(1): 113--128 (2002).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></code>, <code><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">dunif</a></code>, <code><a href="tnorm.html">dtnorm</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## what does the distribution look like?</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">90</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">70</span>, <span class="fl">10</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.06</span><span class="op">)</span><span class="op">)</span> <span class="co">## standard Normal</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="tnorm.html">dtnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">70</span>, <span class="fl">10</span>, <span class="fl">60</span>, <span class="fl">80</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>       <span class="co">## truncated Normal</span></span></span>
<span class="r-in"><span><span class="co">## truncated Normal with small measurement error</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">dmenorm</span><span class="op">(</span><span class="va">x</span>, <span class="fl">70</span>, <span class="fl">10</span>, <span class="fl">60</span>, <span class="fl">80</span>, sderr<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="medists-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

